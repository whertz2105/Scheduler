<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Work Scheduler</title>
  <style>
    table { border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 4px; text-align: center; }
    th { background: #f0f0f0; }
    .actions { margin-bottom: 10px; }
    #container { display: flex; }
    #schedule { flex: 3; }
    #employees { flex: 1; margin-left: 20px; }
  </style>
</head>
<body>
  <div class="actions">
    <button onclick="addEmployee()">Add Employee</button>
    <button onclick="removeEmployee()">Remove Employee</button>
    <button onclick="addPosition()">Add Position/Update Pay</button>
    <button onclick="addShift()">Add Shift</button>
  </div>
  <div id="container">
    <div id="schedule"></div>
    <div id="employees"></div>
  </div>
  <script>
    var DAYS = ["Wednesday","Thursday","Friday","Saturday","Sunday","Monday","Tuesday"];
    var employees = {}; // {name:{job:rate}}
    var shifts = [];    // [{name,start,end,hours,job,period}]
    var assignments = {}; // {'shiftName-dayIndex': employeeName}

    function buildTable() {
      const container = document.getElementById('schedule');
      container.innerHTML = '';
      const table = document.createElement('table');
      var header = '<tr><th>Shifts</th>';
      for (var i = 0; i < DAYS.length; i++) {
        header += '<th>' + DAYS[i] + '</th>';
      }
      header += '</tr>';
      table.innerHTML = header;

      var amShifts = [];
      var pmShifts = [];
      for (var i = 0; i < shifts.length; i++) {
        if (shifts[i].period === 'AM') {
          amShifts.push(shifts[i]);
        } else if (shifts[i].period === 'PM') {
          pmShifts.push(shifts[i]);
        }
      }

      function buildRows(group) {
        for (var g = 0; g < group.length; g++) {
          var shift = group[g];
          var row = document.createElement('tr');
          var label = shift.name + '<br>' + shift.start + '-' + shift.end;
          row.innerHTML = '<td>' + label + '</td>';
          for (var idx = 0; idx < DAYS.length; idx++) {
            var key = shift.name + '-' + idx;
            var select = document.createElement('select');
            var opt = document.createElement('option');
            opt.value = '';
            opt.textContent = '';
            select.appendChild(opt);
            for (var ename in employees) {
              if (employees[ename][shift.job] !== undefined) {
                var o = document.createElement('option');
                o.value = ename;
                o.textContent = ename;
                if (assignments[key] === ename) o.selected = true;
                select.appendChild(o);
              }
            }
            select.onchange = (function(k, sel){ return function(){ assignments[k] = sel.value; }; })(key, select);
            var td = document.createElement('td');
            td.appendChild(select);
            row.appendChild(td);
          }
          table.appendChild(row);
        }
        var line = document.createElement('tr');
        line.innerHTML = '<td><strong>Labor $/hr</strong></td>';
        for (var idx = 0; idx < DAYS.length; idx++) {
          var cell = document.createElement('td');
          cell.id = 'labor-' + (group === amShifts ? 'am' : 'pm') + '-' + idx;
          cell.textContent = '0';
          line.appendChild(cell);
        }
        table.appendChild(line);
      }

      if (amShifts.length) buildRows(amShifts);
      if (pmShifts.length) buildRows(pmShifts);

      var footerRows = ['Projected Sales','Projected Labor ($)','Projected % Labor'];
      for (var r = 0; r < footerRows.length; r++) {
        var label = footerRows[r];
        var row = document.createElement('tr');
        row.innerHTML = '<td>' + label + '</td>';
        for (var idx = 0; idx < DAYS.length; idx++) {
          var cell = document.createElement('td');
          if (r === 0) {
            cell.innerHTML = '<input type="number" min="0" id="sales-' + idx + '" value="0" style="width:80px;">';
          } else {
            cell.id = (r === 1 ? 'labor-total-' : 'labor-percent-') + idx;
            cell.textContent = '0';
          }
          row.appendChild(cell);
        }
        table.appendChild(row);
      }

      var calcRow = document.createElement('tr');
      var calcCell = document.createElement('td');
      calcCell.colSpan = DAYS.length + 1;
      var btn = document.createElement('button');
      btn.textContent = 'Calculate';
      btn.onclick = calculate;
      calcCell.appendChild(btn);
      calcRow.appendChild(calcCell);
      table.appendChild(calcRow);

      container.appendChild(table);
      buildEmployeeTable();
    }

    function calculate() {
      for (var idx = 0; idx < DAYS.length; idx++) {
        var am = document.getElementById('labor-am-' + idx); if (am) am.textContent = '0';
        var pm = document.getElementById('labor-pm-' + idx); if (pm) pm.textContent = '0';
        document.getElementById('labor-total-' + idx).textContent = '0';
        document.getElementById('labor-percent-' + idx).textContent = '0';
      }

      for (var s = 0; s < shifts.length; s++) {
        var shift = shifts[s];
        for (var idx = 0; idx < DAYS.length; idx++) {
          var key = shift.name + '-' + idx;
          var emp = assignments[key];
          if (emp) {
            var rate = employees[emp][shift.job];
            var cost = rate * shift.hours;
            var period = shift.period === 'AM' ? 'am' : 'pm';
            var cell = document.getElementById('labor-' + period + '-' + idx);
            cell.textContent = (parseFloat(cell.textContent) + rate).toFixed(2);
            var totalCell = document.getElementById('labor-total-' + idx);
            totalCell.textContent = (parseFloat(totalCell.textContent) + cost).toFixed(2);
          }
        }
      }

      for (var idx = 0; idx < DAYS.length; idx++) {
        var sales = parseFloat(document.getElementById('sales-' + idx).value) || 0;
        var labor = parseFloat(document.getElementById('labor-total-' + idx).textContent) || 0;
        var percent = sales > 0 ? ((labor / sales) * 100).toFixed(2) : '0';
        document.getElementById('labor-percent-' + idx).textContent = percent;
      }
    }

    function buildEmployeeTable() {
      var container = document.getElementById('employees');
      container.innerHTML = '';
      var table = document.createElement('table');
      var header = '<tr><th>Employee</th><th>Job</th><th>Pay Rate</th></tr>';
      table.innerHTML = header;
      for (var name in employees) {
        var jobs = employees[name];
        for (var job in jobs) {
          var rate = jobs[job];
          var row = document.createElement('tr');
          row.innerHTML = '<td>' + name + '</td><td>' + job + '</td><td>' + rate.toFixed(2) + '</td>';
          table.appendChild(row);
        }
      }
      container.appendChild(table);
    }

    function addEmployee() {
      var name = prompt('Employee name:');
      if (!name) return;
      var job = prompt('Job title:');
      if (!job) return;
      var rate = parseFloat(prompt('Pay rate:'));
      if (isNaN(rate)) return;
      if (!employees[name]) employees[name] = {};
      employees[name][job] = rate;
      buildTable();
    }

    function addPosition() {
      var name = prompt('Employee name:');
      if (!name || !employees[name]) return;
      var job = prompt('Job title to add/update:');
      if (!job) return;
      var rate = parseFloat(prompt('Pay rate:'));
      if (isNaN(rate)) return;
      employees[name][job] = rate;
      buildTable();
    }

    function removeEmployee() {
      var names = Object.keys(employees);
      if (!names.length) return;
      var name = prompt('Employee to remove:\n' + names.join(', '));
      if (employees[name]) {
        delete employees[name];
        buildTable();
      }
    }

    function addShift() {
      var name = prompt('Shift name:');
      if (!name) return;
      var job = prompt('Job title for this shift:');
      if (!job) return;
      var start = prompt('Start time (e.g. 06:00):');
      var end = prompt('End time (e.g. 14:00):');
      var hours = parseFloat(prompt('Hours:')) || 0;
      var period = prompt('AM or PM?', 'AM');
      shifts.push({name: name, job: job, start: start, end: end, hours: hours, period: (period && period.toUpperCase()==='PM')?'PM':'AM'});
      buildTable();
    }

    buildTable();
  </script>
</body>
</html>
